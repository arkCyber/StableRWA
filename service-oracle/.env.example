# =====================================================================================
# RWA Tokenization Platform - Oracle Service Environment Configuration
# 
# Author: arkSong (arksong2018@gmail.com)
# 
# Copy this file to .env and update the values for your environment
# =====================================================================================

# Server Configuration
SERVER_HOST=127.0.0.1
SERVER_PORT=8081
SERVER_WORKERS=4
SERVER_MAX_CONNECTIONS=25000
SERVER_KEEP_ALIVE=75
SERVER_CLIENT_TIMEOUT=5000
SERVER_CLIENT_SHUTDOWN=5000

# Database Configuration
DATABASE_URL=postgresql://oracle_user:oracle_password@localhost:5432/oracle_service
DATABASE_MAX_CONNECTIONS=10
DATABASE_MIN_CONNECTIONS=1
DATABASE_CONNECT_TIMEOUT=30
DATABASE_IDLE_TIMEOUT=600
DATABASE_MAX_LIFETIME=1800

# Redis Configuration
REDIS_URL=redis://localhost:6379
REDIS_MAX_CONNECTIONS=10
REDIS_CONNECTION_TIMEOUT=5
REDIS_COMMAND_TIMEOUT=5
REDIS_RETRY_ATTEMPTS=3

# Security Configuration
JWT_SECRET=your-super-secret-jwt-key-change-in-production-minimum-32-characters-required
JWT_EXPIRATION=3600

# Provider API Keys
# CoinGecko (Free tier: 50 calls/minute, Pro: 500 calls/minute)
COINGECKO_API_KEY=your-coingecko-api-key-here
COINGECKO_ENABLED=true
COINGECKO_WEIGHT=1.00
COINGECKO_RATE_LIMIT_PER_MINUTE=50
COINGECKO_TIMEOUT_SECONDS=10

# CoinMarketCap (Basic: 333 calls/month, Hobbyist: 10,000 calls/month)
COINMARKETCAP_API_KEY=your-coinmarketcap-api-key-here
COINMARKETCAP_ENABLED=false
COINMARKETCAP_WEIGHT=1.20
COINMARKETCAP_RATE_LIMIT_PER_MINUTE=333
COINMARKETCAP_TIMEOUT_SECONDS=10

# Binance (No API key required for public endpoints)
BINANCE_ENABLED=true
BINANCE_WEIGHT=1.10
BINANCE_RATE_LIMIT_PER_MINUTE=1200
BINANCE_TIMEOUT_SECONDS=5

# Chainlink (Requires node setup)
CHAINLINK_ENABLED=false
CHAINLINK_WEIGHT=1.50
CHAINLINK_RATE_LIMIT_PER_MINUTE=60
CHAINLINK_TIMEOUT_SECONDS=15

# Aggregation Configuration
AGGREGATION_DEFAULT_METHOD=weighted_average
AGGREGATION_MIN_SOURCES=2
AGGREGATION_MAX_DEVIATION_PERCENT=10.0
AGGREGATION_CONFIDENCE_THRESHOLD=0.80
AGGREGATION_OUTLIER_DETECTION=true
AGGREGATION_CACHE_TTL_SECONDS=60

# Monitoring Configuration
MONITORING_HEALTH_CHECK_INTERVAL=30
MONITORING_METRICS_ENABLED=true
MONITORING_TRACING_ENABLED=true

# Logging Configuration
RUST_LOG=service_oracle=info,actix_web=info,sqlx=warn
RUST_BACKTRACE=1
LOG_LEVEL=info
LOG_FORMAT=json

# Development Configuration
DEVELOPMENT_MODE=false
DEVELOPMENT_MOCK_PROVIDERS=false
DEVELOPMENT_SEED_DATA=false

# Performance Configuration
PERFORMANCE_WORKER_THREADS=4
PERFORMANCE_BLOCKING_THREADS=512
PERFORMANCE_MAX_BLOCKING_THREADS=512
PERFORMANCE_THREAD_STACK_SIZE=2097152

# Cache Configuration
CACHE_PRICE_TTL_SECONDS=60
CACHE_FEED_TTL_SECONDS=300
CACHE_PROVIDER_STATUS_TTL_SECONDS=30
CACHE_WARMUP_ENABLED=true

# Rate Limiting Configuration
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=1000
RATE_LIMIT_BURST_SIZE=100

# CORS Configuration
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=*
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=*
CORS_MAX_AGE=3600

# SSL/TLS Configuration (for production)
TLS_ENABLED=false
TLS_CERT_PATH=/path/to/cert.pem
TLS_KEY_PATH=/path/to/key.pem

# Webhook Configuration
WEBHOOK_TIMEOUT_SECONDS=30
WEBHOOK_RETRY_ATTEMPTS=3
WEBHOOK_RETRY_DELAY_SECONDS=5

# Alert Configuration
ALERTS_ENABLED=true
ALERTS_EMAIL_ENABLED=false
ALERTS_WEBHOOK_ENABLED=true
ALERTS_SLACK_ENABLED=false

# Email Configuration (if alerts enabled)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=oracle-service@yourcompany.com

# Slack Configuration (if alerts enabled)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#alerts

# Backup Configuration
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket
BACKUP_S3_REGION=us-east-1

# Feature Flags
FEATURE_SUBSCRIPTIONS_ENABLED=true
FEATURE_WEBHOOKS_ENABLED=true
FEATURE_WEBSOCKETS_ENABLED=true
FEATURE_BATCH_REQUESTS_ENABLED=true
FEATURE_HISTORICAL_DATA_ENABLED=true

# Testing Configuration (for test environment)
TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/oracle_test
TEST_REDIS_URL=redis://localhost:6379/1
TEST_MOCK_PROVIDERS=true
TEST_SEED_DATA=true

# Docker Configuration
DOCKER_REGISTRY=your-registry.com
DOCKER_IMAGE_TAG=latest
DOCKER_BUILD_TARGET=production

# Kubernetes Configuration
K8S_NAMESPACE=rwa-platform
K8S_SERVICE_ACCOUNT=oracle-service
K8S_REPLICAS=3
K8S_RESOURCES_REQUESTS_CPU=100m
K8S_RESOURCES_REQUESTS_MEMORY=128Mi
K8S_RESOURCES_LIMITS_CPU=500m
K8S_RESOURCES_LIMITS_MEMORY=512Mi

# Observability Configuration
JAEGER_ENABLED=false
JAEGER_ENDPOINT=http://localhost:14268/api/traces
JAEGER_SERVICE_NAME=oracle-service

PROMETHEUS_ENABLED=true
PROMETHEUS_METRICS_PATH=/metrics
PROMETHEUS_PUSH_GATEWAY=http://localhost:9091

GRAFANA_ENABLED=false
GRAFANA_DASHBOARD_URL=http://localhost:3000

# External Services
EXTERNAL_PRICE_VALIDATOR_URL=http://localhost:8082
EXTERNAL_NOTIFICATION_SERVICE_URL=http://localhost:8083
EXTERNAL_AUDIT_SERVICE_URL=http://localhost:8084

# Circuit Breaker Configuration
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT_SECONDS=60
CIRCUIT_BREAKER_RETRY_TIMEOUT_SECONDS=30

# Retry Configuration
RETRY_MAX_ATTEMPTS=3
RETRY_INITIAL_DELAY_MS=100
RETRY_MAX_DELAY_MS=5000
RETRY_MULTIPLIER=2.0

# Health Check Configuration
HEALTH_CHECK_TIMEOUT_SECONDS=10
HEALTH_CHECK_INTERVAL_SECONDS=30
HEALTH_CHECK_FAILURE_THRESHOLD=3

# Maintenance Configuration
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="Service is under maintenance"
MAINTENANCE_ALLOWED_IPS=127.0.0.1,::1

# Timezone Configuration
TZ=UTC
TIMEZONE=UTC

# Locale Configuration
LANG=en_US.UTF-8
LC_ALL=en_US.UTF-8

# Custom Configuration
CUSTOM_CONFIG_PATH=/app/config/custom.toml
CUSTOM_FEATURE_FLAG_1=false
CUSTOM_FEATURE_FLAG_2=true
